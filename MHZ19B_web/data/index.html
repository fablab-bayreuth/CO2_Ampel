<!DOCTYPE html>
<html>
<head>
<title>CO2-Ampel</title>
<link href='main.css' rel='stylesheet' type='text/css'>
<meta name="theme-color" content="#00878f">
	<meta charset="utf-8">
	<meta
	content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0'
	name='viewport'>
<script src="jquery.min.js" type="text/javascript"></script>
<link rel="shortcut icon" href="favicon.png" type="image/png"/>
<script src="highcharts.js"></script>
<script src="moment.min.js"></script>
<script src="timezone.min.js"></script>
<script src="base64js.min.js"></script>
<script src="BayEOSParser.js"></script>
<script src="chart.js" type="text/javascript"></script>
<script src="WebSocket.js" type="text/javascript"></script>
</head>
<body>
	<div style='text-align: left; display: inline-block; min-width: 260px;width:100%;max-width:600px' class="tabbed">
	<img src="Fablab-Logo.png" class="img-responsive" style="width:40%; float:right;">
	<h1 id="ssid_h1">CO2-Ampel</h1>
   <input checked="checked" id="tab1" type="radio" name="tabs" />
   <input id="tab2" type="radio" name="tabs" />   
   <input id="tab3" type="radio" name="tabs" />   
   <input id="tab4" type="radio" name="tabs" />

   <nav>
      <label for="tab1">Ampel</label>      
      <label for="tab2">Plot</label>
      <label for="tab3">Config</label>
      <label for="tab4">About</label>
   </nav>
	
<figure>
<div class="tab1">
<table>
<tr><td style="text-align:center;">
<svg version="1.1" baseprofile="full" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" 
 xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns"
 width="130" height="330" style="cursor:pointer;">
  <metadata>
    <rdf:RDF>
      <cc:Work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title>Animierte Ampel</dc:title>
        <dc:date>2005-31-12</dc:date>
        <dc:creator>
          <cc:Agent>
            <dc:title>Manuel Strehl</dc:title>
          </cc:Agent>
        </dc:creator>
        <dc:publisher>
          <cc:Agent>
            <dc:title>http://www.manuel-strehl.de</dc:title>
          </cc:Agent>
        </dc:publisher>
        <dc:language>de-DE</dc:language>
        <dc:subject>
          <rdf:Bag>
            <rdf:li>Ampel</rdf:li>
          </rdf:Bag>
        </dc:subject>
        <cc:license rdf:resource="http://creativecommons.org/licenses/by-sa/2.0/" />
        <dc:description>
          Das Bild zeigt das Schema einer Ampel. 
        </dc:description>
      </cc:Work>
      <cc:License rdf:about="http://creativecommons.org/licenses/by-sa/2.0/de/">
        <cc:permits rdf:resource="http://web.resource.org/cc/Reproduction" />
        <cc:permits rdf:resource="http://web.resource.org/cc/Distribution" />
        <cc:requires rdf:resource="http://web.resource.org/cc/Notice" />
        <cc:requires rdf:resource="http://web.resource.org/cc/Attribution" />
        <cc:permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
        <cc:requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
      </cc:License>
    </rdf:RDF>
  </metadata>
  <defs>
     <linearGradient id="back" x1="0" y1="0" x2="0.4" y2="0.9">
      <stop stop-color="#5c656c" offset="0" />
      <stop stop-color="#aab2b7" offset="1" />
    </linearGradient>
    <radialGradient cx="0.5" cy="0.5" r="0.5" fx="0.5" fy="0.5" id="r">
      <stop stop-color="#fc7474" offset="0" />
      <stop stop-color="#d53a3a" offset="0.7" />
      <stop stop-color="#af0000" offset="1" />
    </radialGradient>
    <radialGradient cx="0.5" cy="0.5" r="0.5" fx="0.5" fy="0.5" id="y">
      <stop stop-color="#fcfc74" offset="0" />
      <stop stop-color="#d4d53a" offset="0.7" />
      <stop stop-color="#afa500" offset="1" />
    </radialGradient>
    <radialGradient cx="0.5" cy="0.5" r="0.5" fx="0.5" fy="0.5" id="g">
      <stop stop-color="#74fc94" offset="0" />
      <stop stop-color="#3ad55e" offset="0.7" />
      <stop stop-color="#00af29" offset="1" />
    </radialGradient>
    <radialGradient cx="0.5" cy="0.5" r="0.5" fx="0.5" fy="0.5" id="b">
      <stop stop-color="#4d4d4d" offset="0" />
      <stop stop-color="#1a1a1a" offset="0.7" />
      <stop stop-color="#000000" offset="1" />
    </radialGradient>
    <linearGradient x1="0" y1="0" x2="0" y2="1.05" id="rg">
      <stop stop-color="#fff" stop-opacity="0.9" offset="0" />
      <stop stop-color="#fff" stop-opacity="0.2" offset="0.7" />
      <stop stop-color="#fff" stop-opacity="0.3" offset="1" />
    </linearGradient>
    <path d="M 35,50 A 34,34 0 0,1 95,50 Q 98,55 95,60 Q 65,78 35,60 Q 32,55 35,50 z" fill="url(#rg)" id="reflex" />
  </defs>
  <rect width="120" height="320" x="5" y="5" fill="url(#back)" stroke="#000" stroke-width="10" />
  <circle cx="65"  cy="65" r="40" fill="url(#b)" stroke="#000" stroke-width="8" id="redlight" />
  <circle cx="65" cy="165" r="40" fill="url(#b)" stroke="#000" stroke-width="8" id="yellight" />
  <circle cx="65" cy="265" r="40" fill="url(#b)" stroke="#000" stroke-width="8" id="grelight" />
  <use xlink:href="#reflex" />
  <use xlink:href="#reflex" transform="translate(0,100)" />
  <use xlink:href="#reflex" transform="translate(0,200)" />
</svg>
<script type="text/javascript">
function set_col( c1, c2, c3 ) {
	  if( c1 == 1 )
	    document.getElementById("redlight").setAttribute( "fill", "url(#r)" );
	  else
	    document.getElementById("redlight").setAttribute( "fill", "url(#b)" );
	  if( c2 == 1 )
	    document.getElementById("yellight").setAttribute( "fill", "url(#y)" );
	  else
	    document.getElementById("yellight").setAttribute( "fill", "url(#b)" );
	  if( c3 == 1 )
	    document.getElementById("grelight").setAttribute( "fill", "url(#g)" );
	  else
	    document.getElementById("grelight").setAttribute( "fill", "url(#b)" );
	}

</script>
</td></tr> 
<tr><td><span id="co2">??</span> ppm CO2</td></tr>
</table>
</div>

<div class="tab2">
		<div id="container"></div>
		<table>
		<tr><th colspan=2>Daten Download</th></tr>
		<tr><td colspan=2>Datensätze gesamt: <span id="buffer_total">xx</span><br/>
		Datensätze neu: <span id="buffer_neu">xx</span><br/>
		Datensätze max: <span id="buffer_max">xx</span><br/>
		Datensätze pro Tag: <span id="buffer_tag">xx</span></td></tr>
					<tr><td colspan=2>
			<input type="radio" name="dl_size" id="dl_new" style="width:20px;" checked value="0"><label for="dl_new" id="dl_new_l"> Nur neue Daten seit letztem Download</label><br/>
			<input type="radio" name="dl_size" id="dl_full" style="width:20px;" value="-1"><label for="dl_full" id="dl_full_l"> Alles herunterladen</label><br/>
			<span id="dl_size_span" style="display:yes;">
			<input type="radio" name="dl_size" id="dl_size" style="width:20px;" value="1">
			<select id="dl_size_s" style="width:70px;">
			<option>1</option><option>2</option><option>3</option>
			<option>4</option><option>5</option><option>6</option>
			<option>7</option><option>8</option><option>9</option>
			<option>10</option><option>11</option><option>12</option>
			<option>13</option><option>14</option><option>15</option>
			<option>16</option><option>17</option><option>18</option>
			<option>19</option><option>20</option><option>21</option>
			<option>22</option><option>23</option><option>24</option>
			</select>
			<select id="dl_size_u" style="width:100px;"><option value="1">Stunden</option><option value="24">Tage</option><option value="168">Wochen</option><option value="720">Monate</option>
			</select> <label for="dl_size" id="dl_size_l"> herunterladen</label><br/>
			</span>
			
			</td></tr>
			<tr>
			<td>Dateiformat</td>
			<td><select id="dl_format"><option value="1">csv-Datei</option><option value="0">BayEOS bdb-Datei</option></select>
			<tr>
				<td colspan=2><input id="dl" class="logger" type="button"
					value="Herunterladen" onClick="download()"></td>
			</tr>
			</table>
</div>

<div class="tab3">	

 		<table>
			<tr>
				<td>Ampel-Name</td>
				<td><input class="config" id="name"></td>
			</tr>
			<tr>
				<td>SSID</td>
				<td><input class="config" id="ssid"></td>
			</tr>
			<tr>
				<td>Password</td>
				<td><input class="config" id="password" type="password"></td>
			</tr>
			<tr>
				<td>Grenze Gelb (ppm)</td>
				<td><input class="config" id="low"></td>
			</tr>
			<tr>
				<td>Grenze Rot (ppm)</td>
				<td><input class="config" id="high"></td>
			</tr>
			<tr>
				<td>Grenze Rot Blinken (ppm)</td>
				<td><input class="config" id="blink"></td>
			</tr>
			<tr>
				<td>Ampel aktiv ab</td>
				<td><select class="config" id="ampel_start">
<option value=0>Immer</option>
<option value=300>05:00</option>
<option value=330>05:30</option>
<option value=360>06:00</option>
<option value=390>06:30</option>
<option value=420>07:00</option>
<option value=450>07:30</option>
<option value=480>08:00</option>
<option value=510>08:30</option>
<option value=540>09:00</option>
<option value=570>09:30</option>
<option value=600>10:00</option>
</select></td>
			</tr>
			<tr>
				<td>Ampel inaktiv ab</td>
				<td><select class="config" id="ampel_end">
<option value=0>Nie</option>
<option value=720>12:00</option>
<option value=750>12:30</option>
<option value=780>13:00</option>
<option value=810>13:30</option>
<option value=840>14:00</option>
<option value=870>14:30</option>
<option value=900>15:00</option>
<option value=930>15:30</option>
<option value=960>16:00</option>
<option value=990>16:30</option>
<option value=1020>17:00</option>
<option value=1050>17:30</option>
<option value=1080>18:00</option>
<option value=1110>18:30</option>
<option value=1140>19:00</option>
</select></td>
			</tr>
			<tr>
				<td>Ampel Helligkeit</td>
				<td><select class="config" id="brightness">
<option value=10>10%</option>
<option value=20>20%</option>
<option value=30>30%</option>
<option value=40>40%</option>
<option value=50>50%</option>
<option value=60>60%</option>
<option value=70>70%</option>
<option value=80>80%</option>
<option value=90>90%</option>
<option value=100>100%</option>
</select></td>
			</tr>
			<tr>
				<td>automatische Grundlinien-Korrektur (ABC)</td>
				<td><select class="config" id="autocalibration"><option value=0>Nein</option><option value=1>Ja</option></select></td>
			</tr>
			<tr>
				<td colspan=2><input class="config" type="checkbox" id="zerocal" value=1  style="width: 20px;"><label for="zerocal">Grundlinien-Korrektur jetzt durchführen</label>
			</tr>
			<tr>
				<td>Mode</td>
				<td><select class="config" id="mode"><option value=0>AP-Mode</option><option value=1>Client Mode</option></select></td>
			</tr>
			<tr class="bayeos">
				<td>BayEOS-Name</td>
				<td><input class="config" id="bayeos_name"></td>
			</tr>
			<tr class="bayeos">
				<td>BayEOS-Gateway</td>
				<td><input class="config" id="bayeos_gateway"></td>
			</tr>
			<tr class="bayeos">
				<td>BayEOS-User</td>
				<td><input class="config" id="bayeos_user"></td>
			</tr>
			<tr class="bayeos">
				<td>BayEOS-Password</td>
				<td><input class="config" id="bayeos_pw" type="password"></td>
			</tr>
			<tr>
				<td>Neues Admin Password</td>
				<td><input class="config" id="admin_pw1" type="password"></td>
			</tr>
			<tr>
				<td>Neues Admin Password (Bestätigung)</td>
				<td><input class="config" id="admin_pw2" type="password"></td>
			</tr>
			<tr>
				<td>Admin Password</td>
				<td><input class="config" id="admin_pw" type="password"></td>
			</tr>
			<tr>
				<td colspan=2><input class="config" type="button"
					value="Save" onClick="saveConf()"></td>
			</tr>
		</table>
</div>
<script type="text/javascript">
$("#mode").change(function(){
	if($("#mode").val()=="1") $(".bayeos").show()
	else $(".bayeos").hide()
})
</script>
<div class="tab4">
<p>
CO2-Ampel (c) Fablab Bayreuth
</p>
<p>Frontend Version 0.0.8<br/>
Backend Version <span id="esp_version">X.Y.Z</span>
</p>
</div>
</figure>
<table>
			<tr id="error_tr" style="background-color:#ff0000; font-weight: bold; color: #fff;">
				<td>Error:</td>
				<td id="error">
			</tr>
			<tr id="msg_tr" style="background-color:#00dd00; font-weight: bold; color: #fff;">
				<td>Message:</td>
				<td id="msg">
			</tr>
</table>
</div>

<script>
$(function(){
	$(".config").prop('disabled', true); //disable config on load
	$("#error_tr").hide();
	$("#msg_tr").hide();
	chart = Highcharts.chart('container', {
		chart : {
			type : 'spline',
			zoomType: "xy"
		},
		title : {
			text : 'Verlauf'
		},
		xAxis : {
			type : 'datetime'
		},
		yAxis : [{
			title : {
				text : 'CO2 [ppm]'
			}}
			],
		series : [{
		  	yAxis: 0,
	        name: 'CO2',
	        data: []
	    }]
	})

})

$(function(){ 
	if($("#mode").val()=="0") $(".bayeos").hide() 
});
</script>
</body>
</html>
